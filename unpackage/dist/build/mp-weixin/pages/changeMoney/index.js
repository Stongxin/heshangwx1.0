(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/changeMoney/index"],{1485:function(e,t,n){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={components:{},data:function(){return{popupShow:!1,ischecked:!1,formState:{mid:"30",content_type:"兑币",name:"功德主",mobile:"18013623124",amount:"",source:"wxxcx",openid:e.getStorageSync("openid"),pay_type:"wechat"},orderDetail:{},payList:[{amount:1,ischecked:!1},{amount:3,ischecked:!1},{amount:5,ischecked:!1},{amount:10,ischecked:!1},{amount:15,ischecked:!1},{amount:20,ischecked:!1},{amount:50,ischecked:!1},{amount:100,ischecked:!1}],macno:"",temple_id:""}},onLoad:function(){this.$Route.query?(this.temple_id=this.$Route.query.scene.split("_")[0],this.macno=this.$Route.query.scene.split("_")[1]):e.showToast({title:"设备故障",icon:"error",mask:!0})},methods:{payChecked:function(e,t){var n=this;this.payList.forEach((function(e){e.ischecked=!1,n.formState.amount=""}));var o=this.payList.find((function(t){return t.amount===e}));o&&(o.ischecked=!0,this.formState.amount=o.amount)},submit:function(){var t=this;if(this.macno){var n=this.payList.find((function(e){return!0===e.ischecked}));n&&(this.formState.amount=n.amount),e.getStorageSync("openid")?this.$request({url:"user/WxXxOpendiLogin",data:{openid:e.getStorageSync("openid")}}).then((function(n){e.setStorageSync("token",n.token),e.setStorageSync("mobile",n.mobile),t.mobile=n.mobile,t.$request({url:"buddhist/meritTySubmit",data:t.formState,header:{token:e.getStorageSync("token")}},!0).then((function(e){t.popupShow=!0,t.orderDetail=e}))})):e.login({provider:"weixin",success:function(n){t.$request({url:"onLogin",version:"/vx/",method:"GET",data:{code:n.code,temple_id:e.getStorageSync("temple_id")}}).then((function(n){e.setStorageSync("openid",n.openid),t.$request({url:"user/WxXxOpendiLogin",data:{openid:n.openid}}).then((function(n){e.setStorageSync("token",n.token),e.setStorageSync("mobile",n.mobile),t.mobile=n.mobile,t.$request({url:"buddhist/meritTySubmit",data:t.formState,header:{token:e.getStorageSync("token")}},!0).then((function(e){t.popupShow=!0,t.orderDetail=e}))}))}))}})}else e.showToast({title:"设备故障",icon:"error",mask:!0})},payment:function(){var t=this;e.requestPayment({provider:"wxpay",timeStamp:this.orderDetail.miniPayRequest.timeStamp,nonceStr:this.orderDetail.miniPayRequest.nonceStr,package:this.orderDetail.miniPayRequest.package,signType:this.orderDetail.miniPayRequest.signType,paySign:this.orderDetail.miniPayRequest.paySign,success:function(n){e.redirectTo({url:"/pages/hisOrder/orderDetail?result=true&showImg=true&order_id=".concat(t.orderDetail.merOrderId)}),console.log("支付成功",n),t.walkBi()},fail:function(t){e.showToast({title:"支付失败",icon:"error",mask:!0}),console.log("支付失败",t)}})},walkBi:function(){n.request({url:"https://paybackend.enjoyiot.cn/Wxsite/Device/api?api_name=open_device&macno=".concat(this.macno,"&type=2&value=").concat(this.formState.amount),method:"GET",success:function(e){console.log(e.data)},fail:function(e){console.error(e)}})}}};t.default=o}).call(this,n("df3c")["default"],n("3223")["default"])},"1a33":function(e,t,n){"use strict";var o=n("c7c7"),i=n.n(o);i.a},9951:function(e,t,n){"use strict";n.r(t);var o=n("1485"),i=n.n(o);for(var a in o)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return o[e]}))}(a);t["default"]=i.a},c6e4:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var o={uPopup:function(){return n.e("node-modules/uview-ui/components/u-popup/u-popup").then(n.bind(null,"e07b"))}},i=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.popupShow=!1})},a=[]},c7c7:function(e,t,n){},e6b1:function(e,t,n){"use strict";n.r(t);var o=n("c6e4"),i=n("9951");for(var a in i)["default"].indexOf(a)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(a);n("1a33");var c=n("828b"),r=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"f6b7fcca",null,!1,o["a"],void 0);t["default"]=r.exports},f6c7:function(e,t,n){"use strict";(function(e,t){var o=n("47a9");n("7ea0");o(n("3240"));var i=o(n("e6b1"));e.__webpack_require_UNI_MP_PLUGIN__=n,t(i.default)}).call(this,n("3223")["default"],n("df3c")["createPage"])}},[["f6c7","common/runtime","common/vendor"]]]);