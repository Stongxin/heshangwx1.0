(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/shopro-auth-modal/shopro-auth-modal"],{"1ac0":function(e,t,o){"use strict";var a=o("de7d"),r=o.n(a);r.a},"1cde":function(e,t,o){"use strict";o.r(t);var a=o("271e"),r=o.n(a);for(var n in a)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return a[e]}))}(n);t["default"]=r.a},"271e":function(e,t,o){"use strict";(function(e){var a=o("47a9");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(o("7eb4")),n=a(o("ee10")),s=a(o("7ca3")),i=a(o("4efb")),u=a(o("a930")),d=a(o("3421")),c=o("8f59");function l(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,a)}return o}function f(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?l(Object(o),!0).forEach((function(t){(0,s.default)(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):l(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}var p={name:"shoproAuthModal",data:function(){var e=this;return{platform:this.$platform.get(),device:this.$platform.device(),form:{accountLogin:{data:{account:"",password:""},rules:{account:i.default.account,password:i.default.password},error:{account:"",password:""}},smsLogin:{data:{mobile:"",code:"",isMobileEnd:!1},rules:{code:i.default.code,mobile:i.default.mobile},error:{mobile:"",code:""}},register:{data:{mobile:"",code:"",password:"",isMobileEnd:!1},rules:{code:i.default.code,mobile:i.default.mobile,password:i.default.password},error:{mobile:"",code:"",password:""}},forgotPwd:{data:{mobile:"",code:"",password:"",isMobileEnd:!1},rules:{mobile:i.default.mobile,code:i.default.code,password:i.default.password},error:{mobile:"",code:"",password:""}},bindMobile:{data:{mobile:"",code:"",isMobileEnd:!1},rules:{code:i.default.code,mobile:i.default.mobile},error:{mobile:"",code:""}},changePwd:{data:{oldPassword:"",newPassword:"",reNewPassword:""},rules:{oldPassword:i.default.password,newPassword:i.default.password,reNewPassword:[{required:!0,message:"请重新输入密码",trigger:["change","blur"]},{validator:function(t,o,a){return o===e.form.changePwd.data.newPassword},message:"两次输入的密码不一致",trigger:["change","blur"]}]},error:{oldPassword:"",newPassword:"",reNewPassword:""}}},codeText:"获取验证码",disabledCode:!1,protocol:!1,placeholderStyle:"font-size: 30rpx; font-weight: 500;color:#C2C7CF;"}},computed:f(f({},(0,c.mapGetters)(["initShop","isLogin","authType"])),{},{showAuth:{get:function(){return!!this.authType},set:function(t){t?e.hideTabBar():e.showTabBar()}}}),mounted:function(){},methods:f(f({},(0,c.mapActions)(["getUserInfo","showAuthModal"])),{},{checkValue:function(e,t){this.validation(t)},validation:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o=this,a=this.form[this.authType].data[e],r=this.form[this.authType].rules[e];if(!r||0===r.length)return t("");var n=new u.default((0,s.default)({},e,r));n.validate((0,s.default)({},e,a),{firstFields:!0},(function(a,r){a?"error":"success";var n=a?a[0].message:"";o.form[o.authType].error[e]=n,t(n)}))},validateAll:function(e){var t=this,o=this;return new Promise((function(a){var r=!0,n=0,s=[],i=o.form[o.authType].data;Object.keys(i).map((function(u){o.validation(u,(function(o){o&&(r=!1,s.push(o)),++n===Object.keys(i).length&&(a(r),s.length&&t.$u.toast(s[0]),"function"==typeof e&&e(r))}))}))}))},mobileInput:function(e,t){this.form[this.authType].data.isMobileEnd=this.$u.test.mobile(this.form[this.authType].data.mobile),this.validation(t)},closeAuthModal:function(){this.$store.dispatch("showAuthModal","")},getSmsCode:function(e){var t=this;t.form[this.authType].data.isMobileEnd&&!t.disabledCode?t.$http("common.smsSend",{mobile:t.form[this.authType].data.mobile,event:e},"获取验证码中...").then((function(e){1===e.code?(t.codeChange(),t.$u.toast("验证码已发送，请注意查收短信")):t.$u.toast(e.msg)})):t.$u.toast("请稍后再试")},codeChange:function(){var e=this;if(!this.disabledCode){this.disabledCode=!0;var t=60;this.codeText=t+"s";var o=setInterval((function(){t-=1,t<0&&clearInterval(o),e.codeText=t+"s",e.codeText<"0s"&&(e.disabledCode=!1,e.codeText="重新获取")}),1e3)}},validateSubmit:function(){return["accountLogin","smsLogin","register"].includes(this.authType)&&!this.protocol?(this.$u.toast("请同意用户协议"),!1):this.validateAll()},thirdLogin:function(e){var t=arguments,o=this;return(0,n.default)(r.default.mark((function a(){var n,s,i;return r.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t.length>1&&void 0!==t[1]?t[1]:null,"wxMiniProgram"!==o.platform||null!==n){a.next=3;break}return a.abrupt("return");case 3:if(o.protocol){a.next=6;break}return o.$u.toast("请同意用户协议"),a.abrupt("return",!1);case 6:s=o,i="",a.t0=e,a.next="wechat"===a.t0?11:"alipay"===a.t0?15:"apple"===a.t0?16:20;break;case 11:return a.next=13,d.default.login(n);case 13:return i=a.sent,a.abrupt("break",21);case 15:return a.abrupt("break",21);case 16:return a.next=18,apple.appleIdOauth();case 18:return i=a.sent,a.abrupt("break",21);case 20:return a.abrupt("break",21);case 21:i&&(s.closeAuthModal(),s.getUserInfo(i));case 22:case"end":return a.stop()}}),a)})))()},accountLoginSubmit:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e,t.next=3,o.validateSubmit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}o.$http("user.accountLogin",{account:o.form["accountLogin"].data.account,password:o.form["accountLogin"].data.password},"登录中...").then((function(e){1===e.code&&(o.closeAuthModal(),o.getUserInfo(e.data.token),o.$u.toast(e.msg))}));case 6:case"end":return t.stop()}}),t)})))()},smsLoginSubmit:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e,t.next=3,o.validateSubmit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}o.$http("user.smsLogin",{mobile:o.form["smsLogin"].data.mobile,code:o.form["smsLogin"].data.code},"登录中...").then((function(e){1===e.code&&(o.closeAuthModal(),o.getUserInfo(e.data.token),o.$u.toast(e.msg))}));case 6:case"end":return t.stop()}}),t)})))()},registerSubmit:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e,t.next=3,o.validateSubmit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}o.$http("user.register",{mobile:o.form["register"].data.mobile,code:o.form["register"].data.code,password:o.form["register"].data.password},"注册中...").then((function(e){1===e.code&&(o.$u.toast(e.msg),o.closeAuthModal(),o.getUserInfo(e.data.token))}));case 6:case"end":return t.stop()}}),t)})))()},forgotPwdSubmit:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e,t.next=3,o.validateSubmit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}o.$http("user.forgotPwd",{mobile:o.form["forgotPwd"].data.mobile,code:o.form["forgotPwd"].data.code,password:o.form["forgotPwd"].data.password},"修改中...").then((function(e){1===e.code&&(o.$u.toast(e.msg),o.isLogin?o.closeAuthModal():o.showAuthModal("accountLogin"))}));case 6:case"end":return t.stop()}}),t)})))()},bindMobileSubmit:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e,t.next=3,o.validateSubmit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}o.$http("user.bindMobile",{mobile:o.form["bindMobile"].data.mobile,code:o.form["bindMobile"].data.code,password:o.form["bindMobile"].data.password},"绑定中...").then((function(e){1===e.code&&(o.$u.toast(e.msg),o.closeAuthModal(),o.getUserInfo())}));case 6:case"end":return t.stop()}}),t)})))()},changePwdSubmit:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e,t.next=3,o.validateSubmit();case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}o.$http("user.changePwd",{oldpassword:o.form["changePwd"].data.oldPassword,newpassword:o.form["changePwd"].data.newPassword},"修改中...").then((function(e){1===e.code&&(o.closeAuthModal(),o.$u.toast(e.msg),o.getUserInfo(e.data.userinfo.token))}));case 6:case"end":return t.stop()}}),t)})))()}})};t.default=p}).call(this,o("df3c")["default"])},"326e":function(e,t,o){"use strict";o.r(t);var a=o("90aa"),r=o("1cde");for(var n in r)["default"].indexOf(n)<0&&function(e){o.d(t,e,(function(){return r[e]}))}(n);o("1ac0");var s=o("828b"),i=Object(s["a"])(r["default"],a["b"],a["c"],!1,null,"17deea08",null,!1,a["a"],void 0);t["default"]=i.exports},"90aa":function(e,t,o){"use strict";o.d(t,"b",(function(){return r})),o.d(t,"c",(function(){return n})),o.d(t,"a",(function(){return a}));var a={uInput:function(){return Promise.all([o.e("common/vendor"),o.e("node-modules/uview-ui/components/u-input/u-input")]).then(o.bind(null,"0576"))},uCheckbox:function(){return o.e("node-modules/uview-ui/components/u-checkbox/u-checkbox").then(o.bind(null,"c24b"))}},r=function(){var e=this,t=e.$createElement,o=(e._self._c,"accountLogin"===e.authType||"smsLogin"===e.authType?["App","wxOfficialAccount","wxMiniProgram"].includes(e.platform):null),a=["accountLogin","smsLogin","register"].includes(e.authType);e._isMounted||(e.e0=function(t){return t.stopPropagation(),e.$Router.push({path:"/pages/public/richtext",query:{id:e.initShop.user_protocol||0}})},e.e1=function(t){return t.stopPropagation(),e.$Router.push({path:"/pages/public/richtext",query:{id:e.initShop.privacy_protocol||0}})}),e.$mp.data=Object.assign({},{$root:{g0:o,g1:a}})},n=[]},de7d:function(e,t,o){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/shopro-auth-modal/shopro-auth-modal-create-component',
    {
        'components/shopro-auth-modal/shopro-auth-modal-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('df3c')['createComponent'](__webpack_require__("326e"))
        })
    },
    [['components/shopro-auth-modal/shopro-auth-modal-create-component']]
]);
